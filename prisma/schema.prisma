// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id     Int     @id @default(autoincrement())
  nama   String?
  alamat String
  no_hp  String

  email     String              @unique
  createdAt DateTime            @default(now())
  updatedAt DateTime            @updatedAt
  Transaksi Transaksi[]
  Riwayat   Riwayat_Penukaran[]
  Material  Material[]
}

model Transaksi {
  id            Int      @id @default(autoincrement())
  tgl_transaksi DateTime

  // status        StatusTransaksi //@default(SIMPAN)
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt
  //
  // Material          Material?          @relation(fields: [id_material], references: [id])
  // many
  // id_statusTransaksi Int?
  // Status_Transaksi   StatusTransaksi?   @relation(fields: [id_statusTransaksi], references: [id])
  id_user          Int?
  User             User?             @relation(fields: [id_user], references: [id])
  // one
  // Riwayat_Transaksi Riwayat_Transaksi?
  Sampah_Transaksi Sampah_Transaksi?
  Status_Transaksi Status_Transaksi?
}

model Status_Transaksi {
  id           Int       @id @default(autoincrement())
  type         String
  id_transaksi Int       @unique
  Transaksi    Transaksi @relation(fields: [id_transaksi], references: [id])
}

model Opsi_Penukaran {
  id                Int                 @id @default(autoincrement())
  harga             Int
  deskripsi         String
  Riwayat_Penukaran Riwayat_Penukaran[]
}

model Riwayat_Penukaran {
  id                Int             @id @default(autoincrement())
  tgl_tukar         DateTime
  id_user_penukaran Int?
  id_opsi_penukaran Int?
  User              User?           @relation(fields: [id_user_penukaran], references: [id])
  Opsi_Penukaran    Opsi_Penukaran? @relation(fields: [id_opsi_penukaran], references: [id])
  Material          Material[]
}

// model Riwayat_Transaksi {
//   id           Int        @id @default(autoincrement())
//   tgl_tukar    DateTime
//   id_transaksi Int?       @unique
//   Transaksi    Transaksi? @relation(fields: [id_transaksi], references: [id])
// }

//
model Sampah_Transaksi {
  id           Int        @id @default(autoincrement())
  // nama         String
  total_berat  Int // bukan jumlah per satuan / berat yang akan di beli
  total_harga  Int
  // id_transaksi Int?
  // Sampah    Sampah?    @relation(fields: [id_Sampah], references: [id])
  // Transaksi    Transaksi? @relation(fields: [id_transaksi], references: [id])
  id_Transaksi Int        @unique
  Transaksi    Transaksi  @relation(fields: [id_Transaksi], references: [id])
  Material     Material[]
}

model Material {
  id                   Int                @id @default(autoincrement())
  nama                 String
  berat                Int // total semua benda yang di simpan dalam gudang
  jenis                String // total semua benda yang di simpan dalam gudang
  id_sampahTransaksi   Int?
  id_riwayat_Penukaran Int?
  id_user              Int?
  Sampah_Transaksi     Sampah_Transaksi?  @relation(fields: [id_sampahTransaksi], references: [id])
  Riwayat_Penukaran    Riwayat_Penukaran? @relation(fields: [id_riwayat_Penukaran], references: [id])
  User                 User?              @relation(fields: [id_user], references: [id])
}

// model Sampah {
//   id               Int                @id @default(autoincrement())
//   nama             String
//   Sampah_Transaksi Sampah_Transaksi[]
// }

//

// enum StatusTransaksi {
//   SIMPAN
//   PROSES
//   SELESAI
// }
